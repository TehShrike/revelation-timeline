{{#each timeline as timelineEvent}}
	{{#if timelineEvent.axis.end === timelineEvent.axis.start}}
		<VCenter
			left="{{multiplyIndentByWidth(timelineEvent.indentLevel)}}"
			point="{{multiplyDaysByHeight(timelineEvent.axisAfterStart)}}"
		>
			<div
				class="event"
				data-title="{{timelineEvent.title}}"
				data-days="{{timelineEvent.axis.end - timelineEvent.axis.start + 1}}"
				style="height: {{singleDayHeight}}px;"
				on:mouseover="fire('startHover', timelineEvent)"
				on:mouseleave="fire('endHover', timelineEvent)"
			/>
		</VCenter>
	{{else}}
		<Link
			parameters="{{ clickable ? { zoom: timelineEvent.slug } : null }}"
		>
			<div
				id="{{timelineEvent.slug}}"
				style="
					top: {{multiplyDaysByHeight(timelineEvent.axisAfterStart)}}px;
					left: {{multiplyIndentByWidth(timelineEvent.indentLevel)}}px;
					height: {{multiplyDaysByHeight(timelineEvent.visibleDays)}}px;
				"
				data-top="{{multiplyDaysByHeight(timelineEvent.axisAfterStart)}}"
				data-left="{{multiplyIndentByWidth(timelineEvent.indentLevel)}}"
				class="event"
				data-title="{{timelineEvent.title}}"
				data-days="{{timelineEvent.axis.end - timelineEvent.axis.start + 1}}"
				on:mouseover="fire('startHover', timelineEvent)"
				on:mouseleave="fire('endHover', timelineEvent)"
			>
				<span class="event-title">
					{{timelineEvent.title}}
				</span>
			</div>
		</Link>
	{{/if}}
{{/each}}

<style>
[data-clickable=true] {
	cursor: pointer;
}
.event {
	position: absolute;
	display: flex;
	justify-content: center;
}
.event-title {
	padding: 10px 0;
	-webkit-writing-mode: vertical-rl;
	writing-mode: vertical-rl;
	text-shadow: 0 0 3px black;
	color: white;
}
</style>

<script>
import { multiplyIndentByWidth } from './spacer-functions.js'
import VCenter from './VerticallyCentered.html'
import svelteQuerystringRouter from 'svelte-querystring-router'

export default {
	data() {
		return {
			clickable: false
		}
	},
	helpers: {
		multiplyIndentByWidth,
	},
	computed: {
		multiplyDaysByHeight: dayHeight => days => days * dayHeight,
		singleDayHeight: dayHeight => Math.max(dayHeight, 4)
	},
	components: {
		VCenter,
		Link: svelteQuerystringRouter.Link
	},
}
</script>
